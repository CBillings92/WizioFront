angular.module("AccountApp",[]),angular.module("AccountCreateApp",[]),angular.module("ApartmentDetailsApp",[]),angular.module("BlogApp",[]),angular.module("LandingPageApp",[]),angular.module("LoginApp",[]),angular.module("BrokerApp",[]),angular.module("NavbarApp",[]),angular.module("ApartmentsApp",[]),angular.module("SharedControllersApp",[]),angular.module("SharedFactoriesApp",[]),angular.module("SharedServicesApp",[]),angular.module("SellerApp",[]),angular.module("MainApp",["AccountApp","ApartmentsApp","ApartmentDetailsApp","LandingPageApp","AccountCreateApp","BlogApp","NavbarApp","LoginApp","BrokerApp","SharedControllersApp","SharedFactoriesApp","SharedServicesApp","SellerApp","ui.router","ngStorage","ngResource","ngLodash","ui.bootstrap","angular-jwt"]).run(["$rootScope","$state","$http","$localStorage","jwtHelper",function(e,t,r,o,n){!o.token||n.isTokenExpired(o.token)?e.isLoggedIn=!1:e.isLoggedIn=!0,e.$on("$stateChangeStart",function(r,a,l,s,i){var c=null;return a&&a.data.requireLogin&&(c=a.data.requireLogin),c===!0&&o.token&&n.isTokenExpired(o.token)?(r.preventDefault(),e.isLoggedIn=!1,t.go("Login")):c!==!0||o.token?void(!o.token||n.isTokenExpired(o.token)?e.isLoggedIn=!1:e.isLoggedIn=!0):(r.preventDefault(),e.isLoggedIn=!1,t.go("Login"))})}]),angular.module("MainApp").constant("WizioConfig",{baseAPIURL:"http://localhost:4000/api/"}),angular.module("MainApp").config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(e,t,r,o){var n={templateUrl:"public/viewtemplates/public/navbar.html",controller:"NavbarCtrl"},a={requireLogin:!0};e.state("LandingPage",{url:"/",views:{maincontent:{templateUrl:"public/viewtemplates/public/landingpage.html",controller:"landingpagectrl"}}}).state("ApartmentDetails",{url:"/apartmentdetails/:id",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/apartmentdetailspage.html",controller:"ApartmentDetailsCtrl"}}}).state("ApartmentsDisplay",{url:"/apartments",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/apartmentsdisplay.html",controller:"ApartmentsDisplayCtrl"}}}).state("Blog",{url:"/blog",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/blog.html",controller:"blogctrl"}}}).state("AccountCreate",{url:"/createaccount",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/accountcreate.html",controller:"AccountCreateCtrl"}}}).state("Login",{url:"/login",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/login.html",controller:"LoginCtrl"}}}).state("SendResetEmail",{url:"/sendresetpassemail",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/sendresetpassemail.html",controller:"LoginCtrl"}}}).state("UpdatePassword",{url:"/resetpassword/:token",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/resetpassword.html",controller:"LoginCtrl"}}}).state("CreateApartment",{url:"/createapartment",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/createapartment.html",controller:"CreateApartmentCtrl"}}}).state("UserAccount",{url:"/account","abstract":!0,views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/account/accountmain.html",controller:"AccountCtrl"}},data:a}).state("UserAccount.Dashboard",{url:"/dashboard",views:{accountInfo:{templateUrl:"public/viewtemplates/public/account/accountInfo.html",controller:"AccountInfoCtrl"},appliedApartments:{templateUrl:"public/viewtemplates/public/account/appliedApartments.html",controller:"appliedApartmentsCtrl"},suggestedApartments:{templateUrl:"public/viewtemplates/public/account/suggestedApartments.html",controller:"SuggestedApartmentsCtrl"}}}).state("BrokerAdditionalInfo",{url:"/brokerInfo",views:{navbar:n,maincontent:{templateUrl:"public/viewtemplates/public/brokeraddinfo.html",controller:"BrokerAddInfoCtrl"}}}).state("CreateProfile",{url:"/createprofile",views:{navbar:n,maincontent:{templateUrl:"public/app/modules/buyerapp/profileapp/viewtemplates/profileform.html",controller:"ProfileFormCtrl"}}}),t.otherwise("/"),o.interceptors.push(["$q","$location","$localStorage","$injector",function(e,t,r,o){return{request:function(e){return e.headers=e.headers||{},e.headers.searchCheck?(delete e.headers.searchCheck,e):(r.token&&(e.headers.Authorization=r.token),e)},responseError:function(t){return 401===t.status||403===t.status,o.get("$state").transitionTo("Login"),e.reject(t)}}}])}]),angular.module("AccountApp").controller("AppliedApartmentsCtrl",["$scope","jwtHelper",function(e,t){}]),angular.module("AccountCreateApp").controller("AccountCreateCtrl",["$scope","$state","UserRegistration",function(e,t,r){e.radioModel={realtor:!1,tenant:!0,broker:!1},e.setUserObject=function(){var t={firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password};"tenant"===e.radioModel?t.userType=1:"realtor"===e.radioModel?t.userType=2:"broker"===e.radioModel&&(t.userType=3),r.saveUser(t)}}]),angular.module("ApartmentDetailsApp").controller("ApartmentDetailsCtrl",["$scope","$stateParams","$sessionStorage","$modal","lodash","ApartmentGetSetSvc","ApartmentResource","AuthFct",function(e,t,r,o,n,a,l,s){a.checkApartment(function(t){e.apartment=t}),e.apply=function(){var t=s.getTokenClaims();if(a.set(e.apartment,"apartmentApplyingTo"),null===t.ProfileId){var r=o.open({templateUrl:"public/viewtemplates/public/createprofilemodal.html",controller:"ProfileCreateModalCtrl",size:"md"});r.result.then(function(){},function(){})}}}]),angular.module("ApartmentsApp").factory("ApartmentResource",["$resource",function(e){return e("http://localhost:4000/api/apartment/:id",{id:"@id"})}]),angular.module("BlogApp").controller("blogctrl",["$scope",function(e){e.blogData=[{id:1},{id:2}]}]),angular.module("BrokerApp").factory("brokerResource",["$resource",function(e){return e("http://localhost:4000/api/broker/:action",{action:"@action"})}]),angular.module("LandingPageApp").controller("landingpagectrl",["$scope","$http","$state","UserRegistration","ApartmentSearchSvc",function(e,t,r,o,n){e.radioModel={realtor:!1,tenant:!0,broker:!1},e.search=function(){n.search(e.searchString)},e.getLocation=function(e){return t.get("//maps.googleapis.com/maps/api/geocode/json",{headers:{searchCheck:!0},params:{address:e,sensor:!1,components:"state:MA"}}).then(function(e){return e.data.results.map(function(e){return e.formatted_address})})},e.registerUser=function(){var t={firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password};"tenant"===e.radioModel?t.userType=1:"realtor"===e.radioModel?t.userType=2:"broker"===e.radioModel&&(t.userType=3),o.saveUser(t)}}]),angular.module("LoginApp").controller("LoginCtrl",["$rootScope","$scope","$state","$localStorage","$stateParams","AuthFct","sendresetpassemail","updatepassword",function(e,t,r,o,n,a,l,s){function i(t){o.token=t,e.isLoggedIn=!0,r.go("Home")}t.sendResetEmail=function(){var e={};e.email=t.email,l.save(null,e,function(e,t){r.go("Home")},function(e){})},t.resetPassword=function(){if(t.password===t.passwordConfirm){var e={};e.password=t.password,e.token=n.token,s.save(e,function(e,t){r.go("Login")},function(e){r.go("Login")})}else t.password="",t.passwordConfirm=""},t.requestLogin=function(){var o={email:t.email,password:t.password};a.signin(o,i,function(){e.error="Failed to sign in!",r.go("Home")})}}]),angular.module("NavbarApp").controller("NavbarCtrl",["$rootScope","$scope","$state","$http","ApartmentSearchSvc",function(e,t,r,o,n){t.goToLogin=function(){r.go("Login")},t.search=function(){n.search(t.searchString)},t.getLocation=function(e){return o.get("//maps.googleapis.com/maps/api/geocode/json",{headers:{searchCheck:!0},params:{address:e,sensor:!1,components:"state:MA"}}).then(function(e){return e.data.results.map(function(e){return e.formatted_address})})}}]),angular.module("AccountApp").controller("AccountCtrl",["$scope","$timeout","AuthFct",function(e,t,r){var o=r.getTokenClaims();t(function(){e.$broadcast("AccountInfoBroadcast",o)})}]),angular.module("AccountApp").controller("AccountInfoCtrl",["$scope",function(e){e.$on("AccountInfoBroadcast",function(t,r){e.accountInfo=r})}]),angular.module("AccountApp").controller("appliedApartmentsCtrl",["$scope","jwtHelper",function(e,t){}]),angular.module("AccountApp").controller("ProfileCtrl",["$scope","ApartmentGetSetSvc","AuthFct","ApplicationResource",function(e,t,r,o){t.get("apartmentApplyingTo"),r.getTokenClaims()}]),angular.module("AccountApp").controller("SuggestedApartmentsCtrl",["$scope","jwtHelper",function(e,t){}]),angular.module("ApartmentsApp").controller("Apartment1Ctrl",["$scope",function(e){e.apartment={id:"1",houseNum:"39",street:"Huntington Avenue",unitNum:"3B",city:"Boston",state:"MA",zip:"02115",beds:"3",baths:"2",pets:"Dogs/Cats",livingSpaces:"1",maxResidency:"4",costPerMonth:"3600",renovated:"Yes"}}]),angular.module("ApartmentsApp").controller("Apartment2Ctrl",["$scope",function(e){e.apartment={id:"1",houseNum:"10",street:"Charles Street",unitNum:"3",city:"Boston",state:"MA",zip:"02114",beds:"2",baths:"1",pets:"None",livingSpaces:"1",maxResidency:"3",costPerMonth:"2700",renovated:"Yes"}}]),angular.module("ApartmentsApp").controller("Apartment3Ctrl",["$scope",function(e){e.apartment={id:"3",houseNum:"360",street:"Newbury Street",unitNum:"4",city:"Boston",state:"MA",zip:"02115",beds:"2",baths:"1",pets:"Dogs/Cats",livingSpaces:"1",maxResidency:"4",costPerMonth:"3500",renovated:"Yes"}}]),angular.module("ApartmentsApp").controller("CreateApartmentCtrl",["$scope","$sessionStorage","$rootScope","$state","geocoder","lodash","ApartmentResource",function(e,t,r,o,n,a,l){function s(e){return e[0].long_name?e[0].long_name:e[0].short_name?e[0].short_name:"na"}e.$storage=t,e.states=["AL","AK","AS","AZ","AR","CA","CO","CT","DE","DC","FM","FL","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MH","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","MP","OH","OK","OR","PW","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY"],e.numBeds=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],e.addApartment=function(){function t(t){var r=new google.maps.Geocoder;r.geocode({address:t},function(t,r){if(r==google.maps.GeocoderStatus.OK){var i=a.filter(t[0].address_components,function(e){return"street_number"===e.types[0]}),c=a.filter(t[0].address_components,function(e){return"route"===e.types[0]}),p=a.filter(t[0].address_components,function(e){return"locality"===e.types[0]}),u=a.filter(t[0].address_components,function(e){return"administrative_area_level_3"===e.types[0]}),m=a.filter(t[0].address_components,function(e){return"administrative_area_level_1"===e.types[0]}),d=a.filter(t[0].address_components,function(e){return"postal_code"===e.types[0]}),g=a.filter(t[0].address_components,function(e){return"neighborhood"===e.types[0]});i.length>0&&c.length>0&&(n.street=s(i)+" "+s(c)),g.length>0&&(n.neighborhood=s(g)),p.length>0&&(n.locality=s(p)),u.length>0&&(n.administrative_area_level_3=s(u)),n.state=s(m),n.zip=s(d),n.concatAddress=t[0].formatted_address,n.latitude=parseFloat(t[0].geometry.location.G.toFixed(6)),n.longitude=parseFloat(t[0].geometry.location.K.toFixed(6)),l.save(null,n,function(t,r){e.apartment=t,o.go("MyAccount")})}})}var r=e.street+" "+e.city+" "+e.state+" "+e.zip;t(r);var n={street:e.street,unitNum:e.unitNum,city:e.city,state:e.state,zip:e.zip,beds:e.beds,baths:e.baths,livingSpaces:e.livingRooms,maxResidency:e.maxResidency,costPerMonth:e.costPerMonth,renovated:e.renovated,pets:e.petPolicy,youtubeVRID:e.youtubeVRID};e.street="",e.city="",e.state="",e.zipcode=""}}]),angular.module("ApartmentsApp").controller("ApartmentsDisplayCtrl",["$scope","$sessionStorage","$state","lodash","ApartmentGetSetSvc",function(e,t,r,o,n){e.sessionStorage=t,e.$on("searchFinished",function(t,r){e.apartmentSearch=r}),e.apartmentSearch=t.apartmentSearch,e.apartmentSelected=function(t){var a=o.find(e.apartmentSearch,{id:t});void 0!==a&&(n.set(a,"apartmentSelected"),r.go("ApartmentDetails",{id:t}))}}]),angular.module("ApplicationApp").factory("ApplicationResource",["$resource","WizioConfig",function(e,t){return e(t.baseAPIURL+"application")}]),angular.module("BrokerApp").controller("BrokerAddInfoCtrl",["$scope","brokerResource",function(e,t){e.createBrokerInfo=function(){var r={businessName:e.businessName,licenseID:e.licenseID};t.save({action:"additionalinfo"},r,function(e){})}}]),angular.module("SharedFactoriesApp").factory("AuthFct",["$state","$localStorage","$http","registration",function(e,t,r,o){function n(e){var t=e.replace("-","+").replace("_","/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base 64 string!"}return window.atob(t)}function a(){var e=t.token,r={};if("undefined"!=typeof e&&e.value){var o=e.split(".")[1];r=JSON.parse(n(o))}return r}var l=a();return{signup:function(e,t,r){registration.save(null,e,function(e,t){})},signin:function(e,t,o){r.post("http://localhost:4000/api/user/authenticate",e).success(t).error(o)},logout:function(e){l={},delete t.token,e()},getTokenClaims:function(){var e=t.token,r={};if("undefined"!=typeof e&&e){var o=e.split(".")[1];r=JSON.parse(n(o))}return r}}}]).factory("geocoder",["$q",function(e){var t=function(t){var r=e.defer(),o=new google.maps.Geocoder;return o.geocode({address:t},function(e,t){t===google.maps.GeocoderStatus.OK&&r.resolve(e[0].geometry.location)}),r.promise};return{getLatLong:t}}]).factory("sendresetpassemail",["$resource",function(e){return e("http://localhost:4000/api/user/forgotpassword")}]).factory("updatepassword",["$resource",function(e){return e("http://localhost:4000/api/user/updatepassword")}]).factory("Search",["$resource",function(e){return e("http://localhost:4000/api/search/:flag/:searchString",{flag:"@flag",searchString:"@searchString"})}]).factory("registration",["$resource",function(e){return e("http://localhost:4000/api/user/registration")}]),angular.module("SharedFactoriesApp").factory("Search",["$resource",function(e){return e("http://localhost:4000/api/search/:flag/:searchString",{flag:"@flag",searchString:"@searchString"})}]).factory("registration",["$resource",function(e){return e("http://localhost:4000/api/user/registration")}]).factory("ApplicationResource",["$resource",function(e){return e("http://localhost:4000/api/profile")}]),angular.module("SharedServicesApp").service("ApartmentSearchSvc",["$rootScope","$sessionStorage","Search",function(e,t,r){function o(o){var n=/\D/,a={},l=window.location.href,s=window.location,i=s.protocol+"//"+s.host;l!==i+"/#/apartments"&&(window.location.href=i+"/#/apartments"),null===o.match(n)?(a={string:o,flag:"zip"},r.query(null,{flag:a.flag,searchString:a.string},function(t,r){return e.$broadcast("searchFinished",t),"search complete"})):(a={string:o,flag:"mix"},r.query(null,{flag:a.flag,searchString:a.string},function(r,o){return e.$broadcast("searchFinished",r),t.apartmentSearch=r,"search complete"}))}return{search:o}}]).service("UserRegistration",["$state","registration",function(e,t){function r(r,o){t.save(r,function(t){1===r.userType?e.go("ApartmentsDisplay"):2===r.userType||3===r.userType&&e.go("BrokerAdditionalInfo")})}return{saveUser:r}}]),angular.module("SellerApp").controller("DashSellerAppliedCtrl",["$scope","jwtHelper",function(e,t){}]),angular.module("SellerApp").controller("DashSellerInfoCtrl.js",["$scope",function(e){e.$on("AccountInfoBroadcast",function(t,r){e.accountInfo=r})}]),angular.module("SellerApp").controller("DashSellerMainCtrl",["$scope","$timeout","AuthFct",function(e,t,r){var o=r.getTokenClaims();t(function(){e.$broadcast("AccountInfoBroadcast",o)})}]),angular.module("SellerApp").controller("ProfileCreateModalCtrl",["$scope","$modalInstance","$state",function(e,t,r){e.ok=function(){t.close(),r.go("CreateProfile")},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("SellerApp").controller("ProfileFormCtrl",["$scope","$modal","ApartmentGetSetSvc","AuthFct","ProfileResource","ApplicationResource",function(e,t,r,o,n,a){var l=r.get("apartmentApplyingTo");o.getTokenClaims();e.apply=function(){var r={annualIncome:e.annualIncome,currentEmployer1:e.currentEmployer1,currentEmployerLOE1:e.currentEmployerLOE1,currentEmployerPosition1:e.currentEmployerPosition1,currentEmployer2:e.currentEmployer2,currentEmployerLOE2:e.currentEmployerLOE2,currentEmployerPosition:e.currentEmployerPosition,previousEmployer1:e.previousEmployer1,previousEmployerLOE1:e.previousEmployerLOE1,previousEmployerPosition1:e.previousEmployerPosition1,previousEmployer2:e.previousEmployer2,previousEmployerLOE2:e.previousEmployerLOE2,previousEmployerPosition2:e.previousEmployerPosition2,creditScore:e.creditScore,pets:e.pets,petType:e.petType,age:e.age,maritalStatus:e.maritalStatus,emergencyContact:e.emergencyContact,phoneNumber:e.phoneNumber,socialSecurityNumber:e.socialSecurityNumber,currentBank:e.currentBank,currentTenancyAddress:e.currentTenancyAddress,currentPM:e.currentPM,currentPMContact:e.currentPMContact,previousTenancyAddress:e.previousTenancyAddress,previousPM:e.previousPM,previousPMContact:e.previousPMContact,employmentStatus:e.employmentStatus,desiredMoveInDate:e.desiredMoveInDate},o=t.open({templateUrl:"public/app/modules/sellerapp/profileapp/viewtemplates/profilesavemodal.html",controller:"ProfileSaveModalCtrl",size:"md",resolve:{apartment:function(){return l}}});o.result.then(function(e){r.annualIncome="123","saveAndApply"===e&&n.save(r,function(e,t){200===e&&a.save(application,function(e,t){200===e&&$state.go("account")})})},function(){})}}]),angular.module("SellerApp").controller("ProfileSaveModalCtrl",["$scope","$modalInstance","$state","apartment",function(e,t,r,o){e.apartment=o,e.ok=function(){t.close("saveAndApply")},e.save=function(){t.close("save")},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("SellerApp").factory("ProfileResource",["$resource","WizioConfig",function(e,t){return e(t.baseAPIURL+"profile")}]),angular.module("SharedServicesApp").service("ApartmentGetSetSvc",["$sessionStorage","$stateParams","ApartmentResource","lodash",function(e,t,r,o){var n=null,a=[],l=function(t,r){r&&(e[r]=t,-1===o.indexOf(a,r)&&a.push(r)),n=t},s=function(t){return t?n=e[t]:n},i=function(){n=null},c=function(o){var a=t.id,l=n,s=null;e.apartmentSelected&&(s=e.apartmentSelected.id),null!==l&&l.id===a&&s===a?o(l):s==a?(n=e.apartmentSelected,o(n)):r.get({id:a},function(e){n=e,o(n)})};return{set:l,get:s,reset:i,checkApartment:c}}]);