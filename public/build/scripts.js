angular.module("accountApp",[]),angular.module("accountCreateApp",[]),angular.module("apartmentsApp",[]),angular.module("apartmentDetailsApp",[]),angular.module("blogApp",[]),angular.module("landingPageApp",[]),angular.module("loginApp",[]),angular.module("navbarApp",[]),angular.module("sellerApp",[]),angular.module("sharedControllersApp",[]),angular.module("sharedFactoriesApp",[]),angular.module("sharedServicesApp",[]),angular.module("buyerApp",[]),angular.module("MainApp",["accountApp","apartmentsApp","apartmentDetailsApp","landingPageApp","accountCreateApp","buyerApp","blogApp","navbarApp","loginApp","sellerApp","sharedControllersApp","sharedFactoriesApp","sharedServicesApp","ui.router","ngStorage","ngResource","ngLodash","ui.bootstrap","angular-jwt"]).run(["$rootScope","$state","$http","$localStorage","jwtHelper",function(e,t,r,a,o){!a.token||o.isTokenExpired(a.token)?e.isLoggedIn=!1:e.isLoggedIn=!0,e.$on("$stateChangeStart",function(r,n,l,s,i){var p=null;return n&&n.data.requireLogin&&(p=n.data.requireLogin),p===!0&&a.token&&o.isTokenExpired(a.token)?(r.preventDefault(),e.isLoggedIn=!1,t.go("Login")):p!==!0||a.token?void(!a.token||o.isTokenExpired(a.token)?e.isLoggedIn=!1:e.isLoggedIn=!0):(r.preventDefault(),e.isLoggedIn=!1,t.go("Login"))})}]),angular.module("MainApp").constant("WizioConfig",{baseAPIURL:"http://localhost:4000/api/"}),angular.module("MainApp").config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(e,t,r,a){var o={templateUrl:"public/viewtemplates/public/navbar.html",controller:"navbarCtrl"},n={requireLogin:!0};e.state("LandingPage",{url:"/",views:{maincontent:{templateUrl:"public/viewtemplates/public/landingPage.html",controller:"landingPageCtrl"}}}).state("apartmentDetails",{url:"/apartmentDetails/:id",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/apartmentDetails.html",controller:"apartmentDetailsCtrl"}}}).state("apartmentsDisplay",{url:"/apartmentsDisplay",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/apartmentsDisplay.html",controller:"apartmentsDisplayCtrl"}}}).state("blog",{url:"/blog",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/blog.html",controller:"blogCtrl"}}}).state("accountCreate",{url:"/accountCreate",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/accountCreate.html",controller:"accountCreateCtrl"}}}).state("login",{url:"/login",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/login.html",controller:"loginCtrl"}}}).state("sendResetEmail",{url:"/sendResetEmail",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/sendResetEmail.html",controller:"loginCtrl"}}}).state("updatePassword",{url:"/resetPassword/:token",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/resetPassword.html",controller:"loginCtrl"}}}).state("createApartment",{url:"/createApartment",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/createApartment.html",controller:"createApartmentCtrl"}}}).state("userAccount",{url:"/account","abstract":!0,views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/account/accountMain.html",controller:"accountCtrl"}},data:n}).state("userAccount.dashboard",{url:"/dashboard",views:{accountInfo:{templateUrl:"public/viewtemplates/public/account/accountInfo.html",controller:"accountInfoCtrl"},appliedApartments:{templateUrl:"public/viewtemplates/public/account/appliedApartments.html",controller:"appliedApartmentsCtrl"},suggestedApartments:{templateUrl:"public/viewtemplates/public/account/suggestedApartments.html",controller:"suggestedApartmentsCtrl"}}}).state("sellerDashboard",{url:"/brokerInfo",views:{navbar:o,maincontent:{templateUrl:"public/viewtemplates/public/brokerAddInfo.html",controller:"brokerAddInfoCtrl"}}}).state("createProfile",{url:"/createProfile",views:{navbar:o,maincontent:{templateUrl:"public/app/modules/buyerapp/profileapp/viewtemplates/profileForm.html",controller:"profileFormCtrl"}}}).state("profile.create",{url:"/create",views:{navbar:o,maincontent:{templateUrl:"public/app/modules/buyerapp/profileapp/viewtemplates/profileForm.html",controller:"profileFormCtrl"}}}).state("profile.edit",{url:"/edit",views:{navbar:o,maincontent:{templateUrl:"public/app/modules/buyerapp/profileapp/viewtemplates/profileForm.html",controller:"profileEditCtrl"}}}).state("apartment",{url:"/apartment","abstract":!0}).state("apartment.application",{url:"/application","abstract":!0,data:{requireLogin:!0}}).state("apartment.application.new",{url:"/new",views:{navbar:o,maincontent:{templateUrl:"public/app/modules/applicationapp/applicationformapp/viewtemplates/applicationForm.html",controller:"applicationFormNewCtrl"}}}),t.otherwise("/"),a.interceptors.push(["$q","$location","$localStorage","$injector",function(e,t,r,a){return{request:function(e){return e.headers=e.headers||{},e.headers.searchCheck?(delete e.headers.searchCheck,e):(r.token&&(e.headers.Authorization=r.token),e)},responseError:function(t){return 401===t.status||403===t.status,a.get("$state").transitionTo("Login"),e.reject(t)}}}])}]),angular.module("AccountApp").controller("AppliedApartmentsCtrl",["$scope","jwtHelper",function(e,t){}]),angular.module("accountCreateApp").controller("accountCreateCtrl",["$scope","$state","UserRegistration",function(e,t,r){e.radioModel={realtor:!1,tenant:!0,broker:!1},e.setUserObject=function(){var t={firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password};"tenant"===e.radioModel?t.userType=1:"realtor"===e.radioModel?t.userType=2:"broker"===e.radioModel&&(t.userType=3),r.saveUser(t)}}]),angular.module("apartmentDetailsApp").controller("apartmentDetailsCtrl",["$scope","$stateParams","$sessionStorage","$modal","lodash","ApartmentGetSetSvc","ApartmentResource","AuthFct",function(e,t,r,a,o,n,l,s){n.checkApartment(function(t){e.apartment=t}),e.apply=function(){var t=s.getTokenClaims();if(n.set(e.apartment,"apartmentApplyingTo"),null===t.ProfileId){var r=a.open({templateUrl:"public/viewtemplates/public/createprofilemodal.html",controller:"ProfileCreateModalCtrl",size:"md"});r.result.then(function(){},function(){})}}}]),angular.module("apartmentsApp").factory("apartmentResource",["$resource",function(e){return e("http://localhost:4000/api/apartment/:id",{id:"@id"})}]),angular.module("blogApp").controller("blogCtrl",["$scope",function(e){e.blogData=[{id:1},{id:2}]}]),angular.module("landingPageApp").controller("landingPageCtrl",["$scope","$http","$state","UserRegistration","ApartmentSearchSvc",function(e,t,r,a,o){e.radioModel={realtor:!1,tenant:!0,broker:!1},e.search=function(){o.search(e.searchString)},e.getLocation=function(e){return t.get("//maps.googleapis.com/maps/api/geocode/json",{headers:{searchCheck:!0},params:{address:e,sensor:!1,components:"state:MA"}}).then(function(e){return e.data.results.map(function(e){return e.formatted_address})})},e.registerUser=function(){var t={firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password};"tenant"===e.radioModel?t.userType=1:"realtor"===e.radioModel?t.userType=2:"broker"===e.radioModel&&(t.userType=3),a.saveUser(t)}}]),angular.module("loginApp").controller("loginCtrl",["$rootScope","$scope","$state","$localStorage","$stateParams","AuthFct","sendresetpassemail","updatepassword",function(e,t,r,a,o,n,l,s){function i(t){a.token=t,e.isLoggedIn=!0,r.go("Home")}t.sendResetEmail=function(){var e={};e.email=t.email,l.save(null,e,function(e,t){r.go("Home")},function(e){})},t.resetPassword=function(){if(t.password===t.passwordConfirm){var e={};e.password=t.password,e.token=o.token,s.save(e,function(e,t){r.go("Login")},function(e){r.go("Login")})}else t.password="",t.passwordConfirm=""},t.requestLogin=function(){var a={email:t.email,password:t.password};n.signin(a,i,function(){e.error="Failed to sign in!",r.go("Home")})}}]),angular.module("navbarApp").controller("navbarCtrl",["$rootScope","$scope","$state","$http","ApartmentSearchSvc",function(e,t,r,a,o){t.goToLogin=function(){r.go("Login")},t.search=function(){o.search(t.searchString)},t.getLocation=function(e){return a.get("//maps.googleapis.com/maps/api/geocode/json",{headers:{searchCheck:!0},params:{address:e,sensor:!1,components:"state:MA"}}).then(function(e){return e.data.results.map(function(e){return e.formatted_address})})}}]),angular.module("ApartmentsApp").controller("Apartment1Ctrl",["$scope",function(e){e.apartment={id:"1",houseNum:"39",street:"Huntington Avenue",unitNum:"3B",city:"Boston",state:"MA",zip:"02115",beds:"3",baths:"2",pets:"Dogs/Cats",livingSpaces:"1",maxResidency:"4",costPerMonth:"3600",renovated:"Yes"}}]),angular.module("ApartmentsApp").controller("Apartment2Ctrl",["$scope",function(e){e.apartment={id:"1",houseNum:"10",street:"Charles Street",unitNum:"3",city:"Boston",state:"MA",zip:"02114",beds:"2",baths:"1",pets:"None",livingSpaces:"1",maxResidency:"3",costPerMonth:"2700",renovated:"Yes"}}]),angular.module("ApartmentsApp").controller("Apartment3Ctrl",["$scope",function(e){e.apartment={id:"3",houseNum:"360",street:"Newbury Street",unitNum:"4",city:"Boston",state:"MA",zip:"02115",beds:"2",baths:"1",pets:"Dogs/Cats",livingSpaces:"1",maxResidency:"4",costPerMonth:"3500",renovated:"Yes"}}]),angular.module("apartmentsApp").controller("createApartmentCtrl",["$scope","$sessionStorage","$rootScope","$state","geocoder","lodash","ApartmentResource",function(e,t,r,a,o,n,l){function s(e){return e[0].long_name?e[0].long_name:e[0].short_name?e[0].short_name:"na"}e.$storage=t,e.states=["AL","AK","AS","AZ","AR","CA","CO","CT","DE","DC","FM","FL","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MH","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","MP","OH","OK","OR","PW","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY"],e.numBeds=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],e.addApartment=function(){function t(t){var r=new google.maps.Geocoder;r.geocode({address:t},function(t,r){if(r==google.maps.GeocoderStatus.OK){var i=n.filter(t[0].address_components,function(e){return"street_number"===e.types[0]}),p=n.filter(t[0].address_components,function(e){return"route"===e.types[0]}),c=n.filter(t[0].address_components,function(e){return"locality"===e.types[0]}),u=n.filter(t[0].address_components,function(e){return"administrative_area_level_3"===e.types[0]}),m=n.filter(t[0].address_components,function(e){return"administrative_area_level_1"===e.types[0]}),d=n.filter(t[0].address_components,function(e){return"postal_code"===e.types[0]}),g=n.filter(t[0].address_components,function(e){return"neighborhood"===e.types[0]});i.length>0&&p.length>0&&(o.street=s(i)+" "+s(p)),g.length>0&&(o.neighborhood=s(g)),c.length>0&&(o.locality=s(c)),u.length>0&&(o.administrative_area_level_3=s(u)),o.state=s(m),o.zip=s(d),o.concatAddress=t[0].formatted_address,o.latitude=parseFloat(t[0].geometry.location.G.toFixed(6)),o.longitude=parseFloat(t[0].geometry.location.K.toFixed(6)),l.save(null,o,function(t,r){e.apartment=t,a.go("MyAccount")})}})}var r=e.street+" "+e.city+" "+e.state+" "+e.zip;t(r);var o={street:e.street,unitNum:e.unitNum,city:e.city,state:e.state,zip:e.zip,beds:e.beds,baths:e.baths,livingSpaces:e.livingRooms,maxResidency:e.maxResidency,costPerMonth:e.costPerMonth,renovated:e.renovated,pets:e.petPolicy,youtubeVRID:e.youtubeVRID};e.street="",e.city="",e.state="",e.zipcode=""}}]),angular.module("apartmentsApp").controller("apartmentsDisplayCtrl",["$scope","$sessionStorage","$state","lodash","ApartmentGetSetSvc",function(e,t,r,a,o){e.sessionStorage=t,e.$on("searchFinished",function(t,r){e.apartmentSearch=r}),e.apartmentSearch=t.apartmentSearch,e.apartmentSelected=function(t){var n=a.find(e.apartmentSearch,{id:t});void 0!==n&&(o.set(n,"apartmentSelected"),r.go("ApartmentDetails",{id:t}))}}]),angular.module("ApplicationApp").factory("ApplicationResource",["$resource","WizioConfig",function(e,t){return e(t.baseAPIURL+"application")}]),angular.module("sellerApp").controller("sellerAddInfoCtrl",["$scope","brokerResource",function(e,t){e.createBrokerInfo=function(){var r={businessName:e.businessName,licenseID:e.licenseID};t.save({action:"additionalinfo"},r,function(e){})}}]),angular.module("sellerApp").factory("sellerResource",["$resource",function(e){return e("http://localhost:4000/api/broker/:action",{action:"@action"})}]),angular.module("sharedFactoriesApp").factory("AuthFct",["$state","$localStorage","$http","registration",function(e,t,r,a){function o(e){var t=e.replace("-","+").replace("_","/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base 64 string!"}return window.atob(t)}function n(){var e=t.token,r={};if("undefined"!=typeof e&&e.value){var a=e.split(".")[1];r=JSON.parse(o(a))}return r}var l=n();return{signup:function(e,t,r){registration.save(null,e,function(e,t){})},signin:function(e,t,a){r.post("http://localhost:4000/api/user/authenticate",e).success(t).error(a)},logout:function(e){l={},delete t.token,e()},getTokenClaims:function(){var e=t.token,r={};if("undefined"!=typeof e&&e){var a=e.split(".")[1];r=JSON.parse(o(a))}return r}}}]).factory("geocoder",["$q",function(e){var t=function(t){var r=e.defer(),a=new google.maps.Geocoder;return a.geocode({address:t},function(e,t){t===google.maps.GeocoderStatus.OK&&r.resolve(e[0].geometry.location)}),r.promise};return{getLatLong:t}}]).factory("sendresetpassemail",["$resource",function(e){return e("http://localhost:4000/api/user/forgotpassword")}]).factory("updatepassword",["$resource",function(e){return e("http://localhost:4000/api/user/updatepassword")}]).factory("search",["$resource",function(e){return e("http://localhost:4000/api/search/:flag/:searchString",{flag:"@flag",searchString:"@searchString"})}]).factory("registration",["$resource",function(e){return e("http://localhost:4000/api/user/registration")}]),angular.module("sharedFactoriesApp").factory("search",["$resource",function(e){return e("http://localhost:4000/api/search/:flag/:searchString",{flag:"@flag",searchString:"@searchString"})}]).factory("registration",["$resource",function(e){return e("http://localhost:4000/api/user/registration")}]).factory("ApplicationResource",["$resource",function(e){return e("http://localhost:4000/api/profile")}]),angular.module("sharedServicesApp").service("apartmentSearchSvc",["$rootScope","$sessionStorage","Search",function(e,t,r){function a(a){var o=/\D/,n={},l=window.location.href,s=window.location,i=s.protocol+"//"+s.host;l!==i+"/#/apartments"&&(window.location.href=i+"/#/apartments"),null===a.match(o)?(n={string:a,flag:"zip"},r.query(null,{flag:n.flag,searchString:n.string},function(t,r){return e.$broadcast("searchFinished",t),"search complete"})):(n={string:a,flag:"mix"},r.query(null,{flag:n.flag,searchString:n.string},function(r,a){return e.$broadcast("searchFinished",r),t.apartmentSearch=r,"search complete"}))}return{search:a}}]).service("userRegistration",["$state","registration",function(e,t){function r(r,a){t.save(r,function(t){1===r.userType?e.go("apartmentsDisplay"):2===r.userType||3===r.userType&&e.go("sellerAdditionalInfo")})}return{saveUser:r}}]),angular.module("buyerApp").controller("dashBuyerAppliedCtrl",["$scope","jwtHelper",function(e,t){}]),angular.module("buyerApp").controller("dashBuyerInfoCtrl.js",["$scope",function(e){e.$on("AccountInfoBroadcast",function(t,r){e.accountInfo=r})}]),angular.module("buyerApp").controller("dashBuyerMainCtrl",["$scope","$timeout","AuthFct",function(e,t,r){var a=r.getTokenClaims();t(function(){e.$broadcast("AccountInfoBroadcast",a)})}]),angular.module("buyerApp").controller("ProfileCreateModalCtrl",["$scope","$modalInstance","$state",function(e,t,r){e.ok=function(){t.close(),r.go("CreateProfile")},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("buyerApp").controller("ProfileFormCtrl",["$scope","$modal","ApartmentGetSetSvc","AuthFct","ProfileResource","ApplicationResource",function(e,t,r,a,o,n){var l=r.get("apartmentApplyingTo");a.getTokenClaims();e.apply=function(){var r={annualIncome:e.annualIncome,currentEmployer1:e.currentEmployer1,currentEmployerLOE1:e.currentEmployerLOE1,currentEmployerPosition1:e.currentEmployerPosition1,currentEmployer2:e.currentEmployer2,currentEmployerLOE2:e.currentEmployerLOE2,currentEmployerPosition:e.currentEmployerPosition,previousEmployer1:e.previousEmployer1,previousEmployerLOE1:e.previousEmployerLOE1,previousEmployerPosition1:e.previousEmployerPosition1,previousEmployer2:e.previousEmployer2,previousEmployerLOE2:e.previousEmployerLOE2,previousEmployerPosition2:e.previousEmployerPosition2,creditScore:e.creditScore,pets:e.pets,petType:e.petType,age:e.age,maritalStatus:e.maritalStatus,emergencyContact:e.emergencyContact,phoneNumber:e.phoneNumber,socialSecurityNumber:e.socialSecurityNumber,currentBank:e.currentBank,currentTenancyAddress:e.currentTenancyAddress,currentPM:e.currentPM,currentPMContact:e.currentPMContact,previousTenancyAddress:e.previousTenancyAddress,previousPM:e.previousPM,previousPMContact:e.previousPMContact,employmentStatus:e.employmentStatus,desiredMoveInDate:e.desiredMoveInDate},a=t.open({templateUrl:"public/app/modules/sellerapp/profileapp/viewtemplates/profilesavemodal.html",controller:"ProfileSaveModalCtrl",size:"md",resolve:{apartment:function(){return l}}});a.result.then(function(e){r.annualIncome="123","saveAndApply"===e&&o.save(r,function(e,t){200===e&&n.save(application,function(e,t){200===e&&$state.go("account")})})},function(){})}}]),angular.module("buyerApp").controller("ProfileSaveModalCtrl",["$scope","$modalInstance","$state","apartment",function(e,t,r,a){e.apartment=a,e.ok=function(){t.close("saveAndApply")},e.save=function(){t.close("save")},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("SellerApp").factory("ProfileResource",["$resource","WizioConfig",function(e,t){return e(t.baseAPIURL+"profile")}]),angular.module("BuyerApp").controller("DashBuyerAppliedCtrl",["$scope",function(e){}]),angular.module("SellerApp").controller("DashBuyerAppliedCtrl",["$scope",function(e){}]),angular.module("SellerApp").controller("DashSellerInfoCtrl.js",["$scope",function(e){e.$on("AccountInfoBroadcast",function(t,r){e.accountInfo=r})}]),angular.module("SellerApp").controller("DashBuyerAppliedCtrl",["$scope",function(e){}]),angular.module("SellerApp").controller("DashBuyerAppliedCtrl",["$scope",function(e){}]),angular.module("sharedServicesApp").service("apartmentGetSetSvc",["$sessionStorage","$stateParams","ApartmentResource","lodash",function(e,t,r,a){var o=null,n=[],l=function(t,r){r&&(e[r]=t,-1===a.indexOf(n,r)&&n.push(r)),o=t},s=function(t){return t?o=e[t]:o},i=function(){o=null},p=function(a){var n=t.id,l=o,s=null;e.apartmentSelected&&(s=e.apartmentSelected.id),null!==l&&l.id===n&&s===n?a(l):s==n?(o=e.apartmentSelected,a(o)):r.get({id:n},function(e){o=e,a(o)})};return{set:l,get:s,reset:i,checkApartment:p}}]);